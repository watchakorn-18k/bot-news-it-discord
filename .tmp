MetaFun: Compile Haskell-like code to C++ template metaprograms