How to convert a recursive solution to dynamic programming(3D-DP)